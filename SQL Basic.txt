
---1. FLO tablosunu getirecek sorguyu yazÄ±nÄ±z---

SELECT * FROM flo

---2. KaÃ§ farklÄ± mÃ¼ÅŸterinin alÄ±ÅŸveriÅŸ yaptÄ±ÄŸÄ±nÄ± gÃ¶sterecek sorguyu yazÄ±nÄ±z---

SELECT COUNT(master_id) FROM flo

---3. Toplam Ciro ile toplam alÄ±ÅŸveriÅŸ adedini getirecek sorguyu yazÄ±nÄ±z?---

SELECT SUM(order_num_total_ever_offline) + SUM(order_num_total_ever_online) AS TOPLAMALISVERIS
, SUM(customer_value_total_ever_offline)+SUM(customer_value_total_ever_online) AS TOPLAMCIRO
FROM flo

---4. AlÄ±ÅŸveriÅŸ baÅŸÄ±na ortalama ciroyu getirecek sorguyu yazÄ±nÄ±z.--

SELECT TOPLAMCIRO/TOPLAMALISVERIS AS ORTCIRO FROM
(SELECT SUM(order_num_total_ever_offline) + SUM(order_num_total_ever_online) AS TOPLAMALISVERIS
, SUM(customer_value_total_ever_offline)+SUM(customer_value_total_ever_online) AS TOPLAMCIRO
FROM flo) F

---5. En  son  alÄ±ÅŸveriÅŸ  yapÄ±lan  kanal  (last_order_channel)  Ã¼zerinden  yapÄ±lan  alÄ±ÅŸveriÅŸlerin  toplam  ciro  ve  alÄ±ÅŸveriÅŸ  sayÄ±larÄ±nÄ± getirecek sorguyu yazÄ±nÄ±z.---

SELECT last_order_channel, SUM(order_num_total_ever_offline) + SUM(order_num_total_ever_online) AS TOPLAMALISVERIS
, SUM(customer_value_total_ever_offline)+SUM(customer_value_total_ever_online) AS TOPLAMCIRO
FROM flo 
GROUP BY last_order_channel

---6. YÄ±l kÄ±rÄ±lÄ±mÄ±nda alÄ±ÅŸveriÅŸ adedini getirecek sorguyu yazÄ±nÄ±z (YÄ±l olarak mÃ¼ÅŸterinin â€œilk alÄ±ÅŸveriÅŸ tarihiâ€ (first_order_date) yÄ±lÄ±nÄ± baz alÄ±nÄ±z). Bu soruyu excelâ€™de Ã§Ã¶zÃ¼nÃ¼z ve gÃ¶rselleÅŸtiriniz.

SELECT YEAR(first_order_date) YIL, SUM(order_num_total_ever_offline) + SUM(order_num_total_ever_online) AS TOPLAMALISVERIS
FROM flo  GROUP BY YEAR(first_order_date)

---7. En son alÄ±ÅŸveriÅŸ yapÄ±lan kanal bazÄ±nda alÄ±ÅŸveriÅŸ baÅŸÄ±na ortalama ciroyu hesaplayacak sorguyu yazÄ±nÄ±z.---

SELECT last_order_channel, (SUM(customer_value_total_ever_offline)+SUM(customer_value_total_ever_online))/(SUM(order_num_total_ever_offline) + SUM(order_num_total_ever_online)) ORTCIRO
FROM flo 
GROUP BY last_order_channel

---8. Online  ve  offline  alÄ±ÅŸveriÅŸ  yapan  mÃ¼ÅŸterilerin  toplam  cirolarÄ±nÄ±  ayrÄ±  ayrÄ±  getiren  sorguyu  yazÄ±nÄ±z. Excelâ€™de  online  veoffline platformda alÄ±ÅŸveriÅŸ yapan mÃ¼ÅŸterilerin toplam harcamalarÄ±nÄ± bularak gÃ¶rselleÅŸtiriniz.ğŸ“Ä°pucu: SQL BaÅŸlÄ±klarÄ± â€customer_value_total_ever_offlineâ€ ,  â€œcustomer_value_total_ever_onlineâ€ 

SELECT MASTER_ID, SUM(customer_value_total_ever_offline) OFFLINE,SUM(customer_value_total_ever_online) ONLINE
FROM FLO
GROUP BY MASTER_ID

---9. FLO tablosundaki master_id ve order_channel kolonlarÄ±nÄ± getiren sorguyu yazÄ±nÄ±z.

SELECT master_id,order_channel
FROM FLO

---10. FLO tablosundan 'Offline' olmayan sipariÅŸ kanalÄ±na sahip kayÄ±tlarÄ± getiren sorguyu yazÄ±nÄ±z.

SELECT * FROM flo
WHERE last_order_channel<>'Offline'

---11. FLO tablosundan sipariÅŸ kanalÄ± 'Offline' olmayan ve online alÄ±ÅŸveriÅŸlerinde Ã¶dediÄŸi toplam Ã¼cret 1000'den fazla olan kayÄ±tlarÄ± getiren  sorguyu yazÄ±nÄ±z. AyrÄ±ca excelâ€™de formÃ¼l ile Ã§Ã¶zÃ¼nÃ¼z.

SELECT * FROM flo
WHERE last_order_channel<>'Offline' 
AND customer_value_total_ever_online>1000

---12. FLO  tablosundan  alÄ±ÅŸveriÅŸ  yapÄ±lan  platforma  ait  sipariÅŸ  kanalÄ±  â€˜Mobileâ€˜  olan,  online  ve  offline  alÄ±ÅŸveriÅŸ  yapan mÃ¼ÅŸterilerin toplam cirolarÄ±nÄ± getiren sorguyu yazÄ±nÄ±z.

SELECT master_id, SUM(customer_value_total_ever_offline)+SUM(customer_value_total_ever_online) CIRO
FROM flo
WHERE order_channeL='Mobile'
GROUP BY master_id

---13. Â«interested_in_categories_12Â» kategorisinde iÃ§erisinde â€œSPORâ€ geÃ§en verileri getirecek sorguyu yazÄ±nÄ±z.

SELECT * FROM flo
WHERE interested_in_categories_12 like '%SPOR%'

---14. MÃ¼ÅŸterinin offline alÄ±ÅŸveriÅŸlerinde Ã¶dediÄŸi Ã¼cretin 0 ile 10.000 arasÄ±nda olduÄŸu kayÄ±tlarÄ± getiren sorguyu yazÄ±nÄ±z.

SELECT * FROM flo 
where customer_value_total_ever_offline BETWEEN 0 and 100000

---15. Â«interested_in_categories_12Â» ve  order_channel  bazÄ±nda  online  sipariÅŸ  adetlerini  toplayan  sorguyu  yazÄ±nÄ±z  ve excelâ€™de gÃ¶rselleÅŸtiriniz.

SELECT interested_in_categories_12, order_channel , SUM(order_num_total_ever_online)
 FROM flo 
 GROUP BY interested_in_categories_12, order_channel 

--- 16. En  son  alÄ±ÅŸveriÅŸ  yapÄ±lan  kanal  (last_order_channel)  bazÄ±nda,  ve  kullanÄ±cÄ±larÄ±n  ilgilendiÄŸi  her  bir  kategoriden (interested_in_categories_12)  bazÄ±nda  kaÃ§  adet  alÄ±ÅŸveriÅŸ  yapÄ±ldÄ±ÄŸÄ±nÄ±  getiren  sorguyu  yazÄ±nÄ±z  ve  adet  sayÄ±sÄ±na  gÃ¶re bÃ¼yÃ¼kten kÃ¼Ã§Ã¼ÄŸe doÄŸru sÄ±ralayanÄ±z.

SELECT last_order_channel,interested_in_categories_12, SUM(order_num_total_ever_offline) + SUM(order_num_total_ever_online) ALISVERISSAYISI
 FROM flo
 GROUP BY last_order_channel,interested_in_categories_12
ORDER BY ALISVERISSAYISI ASC

---17. En  Ã§ok  alÄ±ÅŸveriÅŸ  yapan  50  kiÅŸinin  IDâ€™  sini  getiren  sorguyu  yazÄ±nÄ±z. Excelâ€™de  de  en  Ã§ok  alÄ±ÅŸveriÅŸ  yapan  50  mÃ¼ÅŸterininlast_order_channel durumlarÄ±nÄ± inceleyerek,
--- kanal bazlÄ± olarak gÃ¶rselleÅŸtiriniz.

SELECT TOP 50 master_id, SUM(order_num_total_ever_offline) + SUM(order_num_total_ever_online) ALISVERISSAYISI
 FROM flo
 GROUP BY master_id
 ORDER BY ALISVERISSAYISI DESC

---18. First Order Dateâ€™e gÃ¶re yÄ±l bazÄ±nda mÃ¼ÅŸteri adedini getiren sorguyu yazÄ±nÄ±z.

SELECT YEAR(First_Order_Date), COUNT(master_id) MUSTERIADET
FROM flo 
GROUP BY YEAR(First_Order_Date)

--19. Last order dateâ€™i 2020 olan mÃ¼ÅŸterilerin adedini getiren sorguyu yazÄ±nÄ±z.
SELECT COUNT(master_id) MUSTERIADET
FROM flo 
WHERE YEAR(last_order_date)=2020

---20. Sadece  [AKTIFSPOR]  kategorisinden  alÄ±ÅŸveriÅŸ  yapmÄ±ÅŸ  kiÅŸilerin  Order  Channelâ€™larÄ±nÄ±  saÄŸ  tarafa  kolon  olarak  ekleyen sorguyu yazÄ±nÄ±z.

SELECT master_id,interested_in_categories_12, order_channeL FROM FLO 
WHERE interested_in_categories_12='[AKTIFSPOR]'

---21. Ä°Ã§erisinde [AKTIFSPOR] kategorisinden alÄ±ÅŸveriÅŸ yapmÄ±ÅŸ kiÅŸilerin Order Channelâ€™larÄ±nÄ± saÄŸ tarafa kolon olarak ekleyen sorguyu yazÄ±nÄ±z.

SELECT master_id,interested_in_categories_12, order_channeL FROM FLO 
WHERE interested_in_categories_12 LIKE '%AKTIFSPOR%'

---22. 2018  ile  2019  yÄ±llarÄ±  arasÄ±ndaki  her  ay  iÃ§in,  o  ay  ilk  defa  alÄ±ÅŸveriÅŸ  yapan  (yeni)  mÃ¼ÅŸteri  sayÄ±sÄ±nÄ±,  yÄ±l  ve  ay  bilgileriyle birlikte listeleyen sorguyu yazÄ±nÄ±z.

SELECT YIL, AY, MUSTERIADET
FROM
(SELECT YEAR(First_Order_Date) YIL, MONTH(First_Order_Date) AY, COUNT(master_id) MUSTERIADET
FROM flo 
GROUP BY YEAR(First_Order_Date), MONTH(First_Order_Date)) A
WHERE YIL IN (2018,2019)

---23. Order_channelâ€™Ä±    'mobile'  veya  'desktop'  olan  ve  interested_in_categories_12â€™de  'AKTIFSPOR'  olmayan  kayÄ±tlarÄ± getiren sorguyu yazÄ±nÄ±z.

SELECT * FROM flo
WHERE order_channel in ('Mobile','Desktop')
AND interested_in_categories_12 NOT LIKE '%AKTIFSPOR%'

---24. Order_channelda 'Mobile' veya 'Desktop' olan sipariÅŸlerin kayÄ±tlarÄ±nÄ± getiren sorguyu yazÄ±nÄ±z.

SELECT * FROM flo
WHERE order_channel in ('Mobile','Desktop')

---25. Online kanalda alÄ±ÅŸveriÅŸ adedinin en yÃ¼ksek olduÄŸu ayÄ± ve bu aydaki toplam harcama(ciro) bilgilerini getiren sorguyu yazÄ±nÄ±z.

SELECT TOP 1 MONTH(last_order_date_online), SUM(order_num_total_ever_online), SUM(customer_value_total_ever_online)
 FROM flo
GROUP BY MONTH(last_order_date_online)
ORDER BY SUM(order_num_total_ever_online) DESC

---AÅŸaÄŸÄ±daki sorularÄ± Northwind database iÃ§erisinde yapÄ±nÄ±z.
---26. MÃ¼ÅŸteriler ve onlarÄ±n verdiÄŸi sipariÅŸlerin detaylarÄ±nÄ± listeyecek sorguyu inner join ile yazÄ±nÄ±z.

SELECT C.*, OD.*
FROM Customers C
INNER JOIN Orders O ON O.CustomerID=C.CustomerID
INNER JOIN OrderDetails OD ON OD.OrderID=O.OrderID

---27. MÃ¼ÅŸteriler ve onlarÄ±n verdiÄŸi sipariÅŸlerin detaylarÄ±nÄ± listeyecek sorguyu left join ile yazÄ±nÄ±z.

SELECT C.*, OD.*
FROM Customers C
LEFT JOIN Orders O ON O.CustomerID=C.CustomerID
LEFT JOIN OrderDetails OD ON OD.OrderID=O.OrderID

---28. MÃ¼ÅŸteriler ve onlarÄ±n verdiÄŸi sipariÅŸlerin detaylarÄ±nÄ± listeyecek sorguyu right join ile yazÄ±nÄ±z.

SELECT C.*, OD.*
FROM Customers C
RIGHT JOIN Orders O ON O.CustomerID=C.CustomerID
RIGHT JOIN OrderDetails OD ON OD.OrderID=O.OrderID